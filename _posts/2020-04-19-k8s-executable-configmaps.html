---
layout: post
title: K8s Executable ConfigMaps
date: 2020-04-19 15:47:17.000000000 +01:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- kubernetes
tags: []
meta:
  _publicize_job_id: '43222730769'
  timeline_notification: '1587311237'
author:
  login: bobmclarke915800472
  email: bob.mclarke@gmail.com
  display_name: Bob Clarke
  first_name: ''
  last_name: ''
permalink: "/2020/04/19/k8s-executable-configmaps/"
---
<p><!-- wp:paragraph --></p>
<p>To inject a script into a Pod, it's simple enough to use a config map, however if you try to chmod the script to make it executable you'll get an error telling you that the file system is read-only.  This is easily solved by using <strong>defaultMode</strong> parameter</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":862,"width":467,"height":383,"sizeSlug":"medium"} --></p>
<figure class="wp-block-image size-medium is-resized"><img src="{{ site.baseurl }}/assets/image-2.png?w=300" alt="" class="wp-image-862" width="467" height="383" /></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>Here, I'm setting up a volume called pg-backup-script (which is pointing at a configMap named hadoop-ra-postgresql-backup-cm) and I'm setting it's filesystem permissions to -rwxr--r--. I'm then mounting it in the container under /tmp. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":864,"width":467,"height":285,"sizeSlug":"large"} --></p>
<figure class="wp-block-image size-large is-resized"><img src="{{ site.baseurl }}/assets/image-3.png?w=726" alt="" class="wp-image-864" width="467" height="285" /></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>As can be seen, the configMap data has a "key" of backup.sh, which is now executable</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:block {"ref":396} /--></p>
<p><!-- wp:block {"ref":396} /--></p>
<p><!-- wp:paragraph --></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><!-- /wp:paragraph --></p>
