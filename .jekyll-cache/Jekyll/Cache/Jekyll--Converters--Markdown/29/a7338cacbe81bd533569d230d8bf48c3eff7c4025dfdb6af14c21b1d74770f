I"
<p>A pod running in an AKS cluster and trying to pull an image from ACR needs Reader permissions on that ACR.</p>

<p>The simplest way to do this is give the AKS cluster service principal Reader access on the ACR as follows:</p>

<p>First, get the ID of the AKS cluster service principal (note, when you create an AKS cluster an SP is automatically generated):</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">AKS_SP_ID</span><span class="o">=</span><span class="si">$(</span>az aks show <span class="se">\</span>
  <span class="nt">--resource-group</span> &lt;your aks resource group&gt; <span class="se">\</span>
  <span class="nt">--name</span> &lt;your aks cluster name&gt; <span class="se">\</span>
  <span class="nt">--query</span> <span class="s2">"servicePrincipalProfile.clientId"</span> <span class="se">\</span>
  <span class="nt">--output</span> tsv <span class="se">\</span>
  <span class="nt">--subscription</span> &lt;your aks subscription <span class="nb">id</span><span class="o">&gt;</span><span class="si">)</span></code></pre></figure>

<p><br />
Now get the ID of your Azure Container Registry:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">ACR_ID</span><span class="o">=</span><span class="si">$(</span>az acr show <span class="nt">--name</span> &lt;your acr name&gt; <span class="se">\</span>
  <span class="nt">--resource-group</span> &lt;your acr resource group&gt; <span class="se">\</span>
  <span class="nt">--query</span> <span class="s2">"id"</span> <span class="se">\</span>
  <span class="nt">--output</span> tsv <span class="se">\</span>
  <span class="nt">--subscription</span> &lt;your acr subscription <span class="nb">id</span><span class="o">&gt;</span><span class="si">)</span></code></pre></figure>

<p><br />
Now grant your AKS cluster SP Reader rights on your ACR:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">az role assignment create <span class="nt">--assignee</span> <span class="nv">$AKS_SP_ID</span> <span class="nt">--role</span> Reader <span class="se">\</span>
  <span class="nt">--scope</span> <span class="nv">$ACR_ID</span> <span class="nt">--subscription</span> &lt;your acr subscription <span class="nb">id</span><span class="o">&gt;</span></code></pre></figure>

<p>NOTE: Trying to pull a non existent tag can result in an authentication error (e.g. myreg.azurecr.io/docker-camunda:latest as opposed to myreg.azurecr.io/docker-camunda:myreg.azurecr.io/docker-camunda:0.0.10)</p>

:ET